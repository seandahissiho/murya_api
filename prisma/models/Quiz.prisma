model Quiz {
  id        String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  questions QuizQuestion[]
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt

  jobPositioning Job?       @relation("JobPositioningQuiz")
  userQuizzes    UserQuiz[]
}

model QuizQuestion {
  id                 String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  quizId             String           @db.Uuid
  quiz               Quiz             @relation(fields: [quizId], references: [id])
  text               String
  timeLimitInSeconds Int              @default(30)
  points             Int              @default(1)
  type               QuizQuestionType @default(single_choice)
  mediaUrl           String           @default("")
  metadata           Json?
  position           Int              @default(0)
  responses          QuizResponse[]
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @updatedAt

  userAnswers UserQuizAnswer[]

  @@index([quizId])
}

model QuizResponse {
  id         String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  questionId String       @db.Uuid
  question   QuizQuestion @relation(fields: [questionId], references: [id])
  text       String
  metadata   Json?
  isCorrect  Boolean      @default(false)
  points     Int          @default(0)
  index      Int
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt

  selectedInAnswers UserQuizAnswerOption[]

  @@index([questionId])
}
