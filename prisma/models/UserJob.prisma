model UserJob {
  id           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userId       String        @db.Uuid
  jobId        String        @db.Uuid
  status       UserJobStatus @default(TARGET)
  // Optional: manual level or seniority (1â€“5 for example)
  level        Int?
  note         String?       @db.Text
  // Aggregated stats for fast dashboards (optional but useful)
  quizzesCount Int           @default(0)
  totalScore   Int           @default(0) // sum of all quiz totalScore
  maxScoreSum  Int           @default(0) // sum of all quiz maxScore
  lastQuizAt   DateTime?     @db.Timestamp(0)
  createdAt    DateTime      @default(now()) @db.Timestamp(0)
  updatedAt    DateTime      @default(now()) @updatedAt @db.Timestamp(0)
  user         User          @relation(fields: [userId], references: [id], onUpdate: Cascade, onDelete: Cascade)
  job          Job           @relation(fields: [jobId], references: [id], onUpdate: Cascade, onDelete: Cascade)
  userQuizzes  UserQuiz[]

  @@unique([userId, jobId], map: "unique_user_job")
  @@index([userId], map: "idx_user_job_user")
  @@index([jobId], map: "idx_user_job_job")
}
